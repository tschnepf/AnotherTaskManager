# Task Hub production example for Unraid + external nginx reverse proxy.
# Copy to `.env` and replace all placeholder values.

# Required in non-debug environments (minimum 32 chars).
DJANGO_SECRET_KEY=replace-with-strong-random-secret-at-least-32-chars
DJANGO_DEBUG=False

# Public URL hostnames served by Task Hub (comma-separated, no protocol).
DJANGO_ALLOWED_HOSTS=tasks.example.com

# Browser origin(s) allowed to call the API.
CORS_ALLOWED_ORIGINS=https://tasks.example.com
# Trusted browser origin(s) for Django CSRF checks.
CSRF_TRUSTED_ORIGINS=https://tasks.example.com

# Host ports exposed by docker compose.
# If your reverse proxy runs on the same host and can reach localhost,
# you can use 127.0.0.1:8001 to avoid exposing the API externally.
API_PORT=127.0.0.1:8001
WEB_PORT=8080

# Database credentials and connection string.
# Keep DATABASE_URL aligned with POSTGRES_* values below.
POSTGRES_DB=taskhub
POSTGRES_USER=taskhub
POSTGRES_PASSWORD=replace-with-strong-db-password
DATABASE_URL=postgres://taskhub:replace-with-strong-db-password@db:5432/taskhub

REDIS_URL=redis://redis:6379/0

# Required: set at least one non-empty value before startup.
TASKHUB_FIELD_ENCRYPTION_KEY=replace-with-strong-random-encryption-key
# Optional key rotation list (new key first).
TASKHUB_FIELD_ENCRYPTION_KEYS=

# Cookie security for HTTPS deployments.
AUTH_COOKIE_SECURE=true
CSRF_COOKIE_SECURE=true
AUTH_COOKIE_SAMESITE=Lax
# Optional: set if you want cookies pinned to an explicit domain.
# AUTH_COOKIE_DOMAIN=tasks.example.com
# Optional auth token lifetime overrides.
# Defaults are access 5 minutes and refresh 1 day.
# JWT_ACCESS_TOKEN_LIFETIME_MINUTES=5
# JWT_REFRESH_TOKEN_LIFETIME_DAYS=1

AI_MODE=off
AI_LOCAL_BASE_URL=http://local-ai:8000
AI_CLOUD_PROVIDER=
AI_CLOUD_API_KEY=
AI_DEFAULT_MODEL=
AI_DEFAULT_EMBED_MODEL=

GOOGLE_OAUTH_CLIENT_ID=
GOOGLE_OAUTH_CLIENT_SECRET=
# Example: https://tasks.example.com/settings
GOOGLE_OAUTH_REDIRECT_URI=

INBOUND_EMAIL_MODE=imap
IMAP_POLL_INTERVAL_MINUTES=2
TASK_ARCHIVE_CADENCE=weekly
TASK_ARCHIVE_AFTER_DAYS=7

# Attachment capability URL TTL in seconds.
ATTACHMENT_ACCESS_TOKEN_MAX_AGE_SECONDS=900

# App-level inbound ingest throttle (Django/DRF).
THROTTLE_INBOUND_EMAIL_INGEST=30/min

# Mobile API / OIDC (required for iOS OIDC + PKCE)
MOBILE_API_ENABLED=true
KEYCLOAK_AUTH_ENABLED=true
KEYCLOAK_REALM=taskhub
KEYCLOAK_IOS_CLIENT_ID=taskhub-mobile
KEYCLOAK_REQUIRED_AUDIENCE=taskhub-api
# Internal URL used by Django API for JWKS fetches.
KEYCLOAK_BASE_URL=http://keycloak:8080/idp
# Public base URL advertised to mobile clients in /api/mobile/v1/meta.
KEYCLOAK_PUBLIC_BASE_URL=https://tasks.example.com
KEYCLOAK_ALLOWED_PUBLIC_HOSTS=tasks.example.com
KEYCLOAK_ALLOWED_ALGS=RS256
KEYCLOAK_JWKS_SOFT_TTL_SECONDS=300
KEYCLOAK_JWKS_HARD_TTL_SECONDS=3600
KEYCLOAK_JWKS_FETCH_TIMEOUT_SECONDS=3
MOBILE_TOKEN_CLOCK_SKEW_SECONDS=60
MOBILE_TASK_CHANGE_PUSH_ENABLED=true
MOBILE_TASK_CHANGE_PUSH_DEDUPE_WINDOW_SECONDS=10
MOBILE_TASK_CHANGE_PUSH_PROCESS_BATCH_SIZE=200
MOBILE_TASK_CHANGE_PUSH_TRIGGER_ASYNC=true

# Keycloak service (when using docker-compose.unraid.yml)
KEYCLOAK_DB_NAME=keycloak
KEYCLOAK_DB_USER=keycloak
KEYCLOAK_DB_PASSWORD=replace-with-strong-keycloak-db-password
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=replace-with-strong-keycloak-admin-password
KEYCLOAK_HOSTNAME=tasks.example.com
KEYCLOAK_HOSTNAME_STRICT=true
